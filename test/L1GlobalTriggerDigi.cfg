//
// cfg file to run 
// L1Emulator on GEN + SIM + DIGI events 
//

process RunGlobalTriggerDigi = {

    // input file: GEN + SIM + DIGI 
    source = PoolSource {
        untracked vstring fileNames = {
        "/store/relval/2008/3/25/RelVal-RelValQCD_Pt_80_120-1206482438/0000/18565E60-DBFA-DC11-8BCF-000423D991F0.root"
        }
    }

    //replace PoolSource.fileNames = {
    //    "/store/relval/2008/3/25/RelVal-RelValH200ZZ4L-1206482438/0000/22A4C4F6-EEFB-DC11-8D93-000423D98BE8.root"
    //}
    
    
    untracked PSet maxEvents = { untracked int32 input = 500 }
    
    // load and configure modules
            
    // Geometry - to be revised
    include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
    include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
    
    //
    include "Configuration/StandardSequences/data/FrontierConditions.cff"

    // L1 Emulator
    include "L1Trigger/Configuration/data/L1Emulator.cff"

    // prescaled menu    
    include "L1TriggerConfig/L1GtConfigProducers/data/Luminosity/lumi1x1032/L1Menu2007.cff"
    //include "L1TriggerConfig/L1GtConfigProducers/data/Luminosity/lumi1030/L1Menu2008_2E30.cff"
    //include "L1TriggerConfig/L1GtConfigProducers/data/Luminosity/lumi1031/L1Menu2008_2E31.cff"
    
    // uprescaled menu - change prescale factors to 1
    //include "L1TriggerConfig/L1GtConfigProducers/data/Luminosity/lumi1x1032/L1Menu2007_Unprescaled.cff"
    //include "L1TriggerConfig/L1GtConfigProducers/data/Luminosity/lumi1030/L1Menu2008_2E30_Unprescaled.cff"
    //include "L1TriggerConfig/L1GtConfigProducers/data/Luminosity/lumi1031/L1Menu2008_2E31_Unprescaled.cff"

    // logical flag to produce the L1 GT DAQ readout record
    //     if true, produce the record (default)
    //replace gtDigis.ProduceL1GtDaqRecord = false
    
    // logical flag to produce the L1 GT EVM readout record
    //     if true, produce the record (default)
    //replace gtDigis.ProduceL1GtEvmRecord = false

    // logical flag to produce the L1 GT object map record
    //     if true, produce the record (default)
    //replace gtDigis.ProduceL1GtObjectMapRecord = false

    // logical flag to write the PSB content in the  L1 GT DAQ record
    //     if true, write the PSB content in the record (default)
    //replace gtDigis.WritePsbL1GtDaqRecord = false

    // logical flag to read the technical trigger records
    //     if true, it will read via getMany the available records (default)
    //replace gtDigis.ReadTechnicalTriggerRecords = false
    
    // number of "bunch crossing in the event" (BxInEvent) to be emulated
    // symmetric around L1Accept (BxInEvent = 0):
    //    1 (BxInEvent = 0); 3 (F 0 1) (standard record); 5 (E F 0 1 2) (debug record)
    // even numbers (except 0) "rounded" to the nearest lower odd number
    // negative value: emulate TotalBxInEvent as given in EventSetup  
    //replace gtDigis.EmulateBxInEvent = 3

    // module list
    path p = { L1Emulator }

    // uncomment / comment messages with DEBUG mode to run in DEBUG mode
    service = MessageLogger {

        untracked vstring destinations =  {"L1GlobalTrigger_RelVal-QCD_Pt_80_120"}
       //untracked vstring destinations =  {"L1GlobalTrigger_RelValH200ZZ4L"}

        untracked PSet L1GlobalTrigger_RelVal-QCD_Pt_80_120 = { 
        //untracked PSet L1GlobalTrigger_RelValH200ZZ4L = { 

            //untracked string threshold = "DEBUG"                  // DEBUG 
            //untracked PSet DEBUG = { untracked int32 limit = -1}  // DEBUG, all messages  
            //untracked PSet DEBUG = { untracked int32 limit = 10}  // DEBUG, max 10 messages  
            untracked PSet INFO = { untracked int32 limit = -1}    

        }
    //untracked vstring debugModules = { "gtDigis"}              // DEBUG  
      
    }

    // keep only GMT, GCT and GT output records
    // update labels if InputTags are replaced!
            
    module outputL1GlobalTrigger = PoolOutputModule { 
        untracked bool fastCloning = false
        untracked vstring outputCommands = {
            "drop *",
            "keep *_gmtDigis_*_*",
            "keep *_gctDigis_*_*",
            "keep *_gtDigis_*_*",
            "keep *_l1GtRecord_*_*"
        }

        untracked string fileName = "L1GlobalTrigger_RelVal-QCD_Pt_80_120.root" 
        //untracked string fileName = "L1GlobalTrigger_RelValH200ZZ4L.root" 

    }
    
    endpath outpath = { outputL1GlobalTrigger }
        
}