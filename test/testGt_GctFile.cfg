//
// cfg file to run L1 Global Trigger emulator on a file containing the output of the 
// GCT system, with GMT blocked 
//
    
process TestGtGctFile = {

    // source file: GCT produced file 
    source = PoolSource {
        untracked vstring fileNames = {
            'file:/afs/cern.ch/user/g/ghete/scratch0/CmsswTestFiles/testGt_Emulator_GctFile_source.root'
        }
    }    

    untracked PSet maxEvents = { untracked int32 input = 10 }
    
    // load and configure modules
    
    // L1 GT EventSetup
    include "L1TriggerConfig/L1GtConfigProducers/data/L1GtConfig.cff"
    
    // uprescaled menu - change prescale factors to 1 (except MinBias and ZeroBias)
    //include "L1TriggerConfig/L1GtConfigProducers/data/L1GtFactorsUnprescale.cff"
            
    // Global Trigger emulator
    include "L1Trigger/GlobalTrigger/data/l1GtEmulDigis.cfi"

    // block GMT input
    replace l1GtParameters.ActiveBoards = 0xFEFF

    // input tag for GCT readout collections: 
    //     l1GctEmulDigis = GCT emulator (default) 
    //     l1GctHwDigis   = GCT unpacker 
    //replace l1GtEmulDigis.GctInputTag = l1GctHwDigis

    
    
    // logical flag to produce the L1 GT DAQ readout record
    //     if true, produce the record (default)
    //replace l1GtEmulDigis.ProduceL1GtDaqRecord = false
    
    // logical flag to produce the L1 GT EVM readout record
    //     if true, produce the record (default)
    //replace l1GtEmulDigis.ProduceL1GtEvmRecord = false

    // logical flag to produce the L1 GT object map record
    //     if true, produce the record (default)
    //replace l1GtEmulDigis.ProduceL1GtObjectMapRecord = false

    // logical flag to write the PSB content in the  L1 GT DAQ record
    //     if true, write the PSB content in the record (default)
    //replace l1GtEmulDigis.WritePsbL1GtDaqRecord = false

    
    // module list
    path p = { l1GtEmulDigis }

    // uncomment / comment messages with DEBUG mode to run in DEBUG mode
    service = MessageLogger {

        untracked vstring destinations =  {"testGt_Emulator_GctFile"}
        untracked PSet testGt_Emulator_GctFile = { 
            untracked string threshold = "DEBUG"                  // DEBUG 
            untracked PSet DEBUG = { untracked int32 limit = -1}  // DEBUG, all messages  
            //untracked PSet DEBUG = { untracked int32 limit = 10}  // DEBUG, max 10 messages  
          untracked PSet INFO = { untracked int32 limit = -1}    
        }
    untracked vstring debugModules = { "l1GtEmulDigis"}              // DEBUG  
      
    }

    // keep GCT and GT output records
    // update labels if InputTags are replaced!
            
    module outputL1GlobalTrigger = PoolOutputModule { 
        untracked vstring outputCommands = {
            "drop *",
            "keep *_l1GctEmulDigis_*_*",
            "keep *_l1GtEmulDigis_*_*"
        }

        untracked string fileName = "testGt_Emulator_GctFile_output.root" 
    }
    
    endpath outpath = { outputL1GlobalTrigger }
        
}