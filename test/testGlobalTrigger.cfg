//
// cfg file to run L1 Global Trigger emulator on a file containing the output of the 
// GCT system and GMT system
//

process TestGlobalTrigger = {

    // source file: GCT + GMT produced file 
    source = PoolSource {
        untracked vstring fileNames = {
            'file:/afs/cern.ch/user/g/ghete/scratch0/CmsswTestFiles/testGt_Emulator_GctGmtFile_source.root'
        }
    }    

    untracked PSet maxEvents = { untracked int32 input = 25 }

    // load and configure modules
    
    // L1 GT EventSetup
    include "L1TriggerConfig/L1GtConfigProducers/data/L1GtConfig.cff"
    
    // one BxInEvent only in GT emulator
    //replace l1GtParameters.TotalBxInEvent = 1
    
    // prescaled menu    
    include "L1TriggerConfig/L1GtConfigProducers/data/Luminosity/lumi1x1032/L1Menu2007.cff"
    //include "L1TriggerConfig/L1GtConfigProducers/data/Luminosity/lumi1030/L1Menu2008_2E30.cff"
    //include "L1TriggerConfig/L1GtConfigProducers/data/Luminosity/lumi1031/L1Menu2008_2E31.cff"

    // uprescaled menu - change prescale factors to 1
    //include "L1TriggerConfig/L1GtConfigProducers/data/Luminosity/lumi1x1032/L1Menu2007_Unprescaled.cff"
    //include "L1TriggerConfig/L1GtConfigProducers/data/Luminosity/lumi1030/L1Menu2008_2E30_Unprescaled.cff"
    //include "L1TriggerConfig/L1GtConfigProducers/data/Luminosity/lumi1031/L1Menu2008_2E31_Unprescaled.cff"
            
    // Global Trigger emulator
    include "L1Trigger/GlobalTrigger/data/gtDigis.cfi"

    // input tag for GMT readout collection: 
    //     gmtDigis = GMT emulator (default)
    //     l1GtUnpack     = GT unpacker (common GT/GMT unpacker)
    //replace gtDigis.GmtInputTag = l1GtUnpack
    
    // input tag for GCT readout collections: 
    //     gctDigis = GCT emulator (default) 
    //     l1GctHwDigis   = GCT unpacker 
    //replace gtDigis.GctInputTag = l1GctHwDigis


    // logical flag to produce the L1 GT DAQ readout record
    //     if true, produce the record (default)
    //replace gtDigis.ProduceL1GtDaqRecord = false
    
    // logical flag to produce the L1 GT EVM readout record
    //     if true, produce the record (default)
    //replace gtDigis.ProduceL1GtEvmRecord = false

    // logical flag to produce the L1 GT object map record
    //     if true, produce the record (default)
    //replace gtDigis.ProduceL1GtObjectMapRecord = false

    // logical flag to write the PSB content in the  L1 GT DAQ record
    //     if true, write the PSB content in the record (default)
    //replace gtDigis.WritePsbL1GtDaqRecord = false

    // logical flag to read the technical trigger records
    //     if true, it will read via getMany the available records (default)
    //replace gtDigis.ReadTechnicalTriggerRecords = false

    // module list
    path p = { gtDigis }

    include "FWCore/MessageService/data/MessageLogger.cfi"
    replace MessageLogger.categories = { "*" }
    replace MessageLogger.destinations =  { "cout" }
    replace MessageLogger.cout = { 
      //untracked string threshold = "ERROR" 
      //untracked string threshold = "INFO" 
      //untracked PSet INFO = { untracked int32 limit = -1}
      untracked string threshold = "DEBUG"                // DEBUG
      untracked PSet DEBUG = { untracked int32 limit = -1}  // DEBUG, all messages
      //untracked PSet DEBUG = { untracked int32 limit = 0}   // DEBUG, no messages
    }
    replace MessageLogger.debugModules = { "gtDigis"}              // DEBUG  
    untracked PSet options   = { untracked bool wantSummary = true }   
       
    // keep GMT, GCT and GT output records
    // update labels if InputTags are replaced!
            
    module outputL1GlobalTrigger = PoolOutputModule { 
        untracked vstring outputCommands = {
            "drop *",
            "keep *_gmtDigis_*_*",
            "keep *_gctDigis_*_*",
            "keep *_gtDigis_*_*"
        }
    
        untracked string fileName = "testGt_Emulator_GctGmtFile_output.root" 
    }
    
    endpath outpath = { outputL1GlobalTrigger }
    
    
    
}